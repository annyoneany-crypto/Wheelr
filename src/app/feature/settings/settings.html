<div class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-neutral-950/90 backdrop-blur-sm">
          <div class="bg-neutral-800 w-full max-w-md rounded-2xl p-6 shadow-2xl border border-neutral-700 overflow-y-auto max-h-[90vh]">
            <div class="flex justify-between items-center mb-6">
              <h2 class="text-xl font-bold">Personalizzazione</h2>
              <button (click)="wheelConfigurator.showModal.set(false)" class="text-neutral-400 hover:text-white text-2xl">✕</button>
            </div>

            <!-- Palette -->
            <div class="mb-6 p-4 bg-neutral-900 rounded-xl border border-neutral-700">
              <label class="block text-sm font-semibold text-yellow-400 mb-3 uppercase tracking-wider">Palette Wheel</label>
              <div class="grid grid-cols-2 gap-2">
                @for (palette of wheelConfigurator.palettes(); track palette.name) {
                  <button (click)="wheelConfigurator.selectedPalette.set(palette)" class="p-2 rounded-lg border flex flex-col gap-2 transition-all"
                    [class.border-yellow-400]="wheelConfigurator.selectedPalette().name === palette.name"
                    [class.border-neutral-700]="wheelConfigurator.selectedPalette().name !== palette.name">
                    <span class="text-[10px] uppercase font-bold">{{ palette.name }}</span>
                    <div class="flex h-3 w-full rounded-full overflow-hidden">
                      @for (color of palette.colors.slice(0, 5); track color) { <div [style.backgroundColor]="color" class="flex-1"></div> }
                    </div>
                  </button>
                }
              </div>
            </div>
            
            <!-- Background -->
            <div class="mb-6 p-4 bg-neutral-900 rounded-xl border border-neutral-700">
              <label class="block text-sm font-semibold text-pink-400 mb-3 uppercase tracking-wider">Background</label>
              <div class="space-y-3">
                <input type="color" [value]="wheelConfigurator.bgColor()" (input)="onBgColorChange($event)" class="w-full h-8 rounded cursor-pointer">
                <button (click)="bgFileInput.click()" class="w-full bg-neutral-700 py-2 rounded-lg text-xs">Upload Background Image</button>
                <input #bgFileInput type="file" (change)="onBgFileSelected($event)" accept="image/*" class="hidden">
                <button (click)="resetBackground()" class="w-full text-xs text-red-400 underline">Reset Background</button>
              </div>
            </div>

            <!-- Central Logo -->
            <div class="mb-6 p-4 bg-neutral-900 rounded-xl border border-neutral-700">
              <label class="block text-sm font-semibold text-purple-400 mb-3 uppercase tracking-wider">Central Logo</label>
              <button (click)="fileInput.click()" class="w-full bg-neutral-700 py-2 rounded-lg text-xs mb-2">Load Logo</button>
              <input #fileInput type="file" (change)="onFileSelected($event)" accept="image/*" class="hidden">
              <input #urlInput type="text" placeholder="URL Logo..." (keyup.enter)="wheelConfigurator.centerImage.set(urlInput.value)" class="w-full bg-neutral-950 border border-neutral-700 rounded-lg px-3 py-2 text-sm">
            </div>

            <!-- Names -->
            <div class="mb-4">
              <label class="block text-sm font-semibold text-cyan-400 mb-2 uppercase tracking-wider">Participants ({{ wheelConfigurator.names().length }})</label>
              <div class="flex gap-2">
                <input #nameInput type="text" (keyup.enter)="addName(nameInput)" class="flex-1 bg-neutral-900 border border-neutral-700 rounded-lg px-4 py-2">
                <button (click)="addName(nameInput)" class="bg-purple-600 px-4 rounded-lg">+</button>
              </div>
            </div>

            <div class="max-h-40 overflow-y-auto mb-6 bg-neutral-900 rounded-lg p-2 flex flex-wrap gap-2 border border-neutral-700">
              @for (name of wheelConfigurator.names(); track $index) {
                <span class="bg-neutral-700 px-3 py-1 rounded-full text-xs flex items-center gap-2">
                  {{ name }} <button (click)="removeName($index)" class="text-red-400">×</button>
                </span>
              }
            </div>

            <button (click)="onClose.emit()" class="w-full py-3 bg-white text-neutral-900 rounded-xl font-bold">Salva</button>
          </div>
        </div>
